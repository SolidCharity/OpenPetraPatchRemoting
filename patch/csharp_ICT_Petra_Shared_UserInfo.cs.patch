--- before/csharp/ICT/Petra/Shared/UserInfo.cs	2014-05-15 21:53:13.000000000 +0200
+++ patched/csharp/ICT/Petra/Shared/UserInfo.cs	2014-05-15 21:56:00.000000000 +0200
@@ -4,7 +4,7 @@
 // @Authors:
 //       timop
 //
-// Copyright 2004-2012 by OM International
+// Copyright 2004-2014 by OM International
 //
 // This file is part of OpenPetra.org.
 //
@@ -22,6 +22,7 @@
 // along with OpenPetra.org.  If not, see <http://www.gnu.org/licenses/>.
 //
 using System;
+using Ict.Common.Session;
 using Ict.Petra.Shared;
 using Ict.Petra.Shared.Security;
 
@@ -34,53 +35,15 @@
     public class UserInfo
     {
         /// <summary>used internally to hold User Information</summary>
-        private static TPetraPrincipal MUserInfo = null;
-
-        /// <summary>
-        /// delegate for setting the object for this current session
-        /// </summary>
-        public delegate void ObjectSetter(TPetraPrincipal value);
-        /// <summary>
-        /// delegate for getting the object for this current session
-        /// </summary>
-        public delegate TPetraPrincipal ObjectGetter();
-
-        private static ObjectSetter ObjDelegateSet = null;
-        private static ObjectGetter ObjDelegateGet = null;
-
-        /// we cannot have a reference to System.Web for Session here, so we use a delegate
-        public static void SetFunctionForRetrievingCurrentObjectFromWebSession(
-            ObjectSetter setter,
-            ObjectGetter getter)
-        {
-            ObjDelegateSet = setter;
-            ObjDelegateGet = getter;
-        }
-
-        /// <summary>used internally to hold User Information</summary>
         public static TPetraPrincipal GUserInfo
         {
             set
             {
-                if (ObjDelegateSet == null)
-                {
-                    MUserInfo = value;
-                }
-                else
-                {
-                    ObjDelegateSet(value);
-                }
+                TSession.SetVariable("UserInfo", value);
             }
             get
             {
-                if (ObjDelegateGet == null)
-                {
-                    return MUserInfo;
-                }
-                else
-                {
-                    return ObjDelegateGet();
-                }
+                return (TPetraPrincipal)TSession.GetVariable("UserInfo");
             }
         }
     }
