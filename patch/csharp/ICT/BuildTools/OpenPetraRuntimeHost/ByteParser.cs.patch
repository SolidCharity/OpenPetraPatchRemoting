--- openpetraNow.freeze2014_05/csharp/ICT/BuildTools/OpenPetraRuntimeHost/ByteParser.cs	1970-01-01 01:00:00.000000000 +0100
+++ openpetraNow.PatchRemoting/csharp/ICT/BuildTools/OpenPetraRuntimeHost/ByteParser.cs	2014-05-15 22:04:07.000000000 +0200
@@ -0,0 +1,67 @@
+/* **********************************************************************************
+*
+* Copyright (c) Microsoft Corporation. All rights reserved.
+*
+* This source code is subject to terms and conditions of the Microsoft Public
+* License (Ms-PL). A copy of the license can be found in the license.htm file
+* included in this distribution.
+*
+* You must not remove this notice, or any other, from this software.
+*
+* **********************************************************************************/
+
+using System;
+using System.Collections;
+using System.Text;
+
+namespace Ict.Tools.OpenPetraRuntimeHost
+{
+    class ByteParser
+    {
+        byte[] _bytes;
+        int _pos;
+
+        public ByteParser(byte[] bytes)
+        {
+            _bytes = bytes;
+            _pos = 0;
+        }
+
+        public int CurrentOffset {
+            get
+            {
+                return _pos;
+            }
+        }
+
+        public ByteString ReadLine()
+        {
+            ByteString line = null;
+
+            for (int i = _pos; i < _bytes.Length; i++)
+            {
+                if (_bytes[i] == (byte)'\n')
+                {
+                    int len = i - _pos;
+
+                    if ((len > 0) && (_bytes[i - 1] == (byte)'\r'))
+                    {
+                        len--;
+                    }
+
+                    line = new ByteString(_bytes, _pos, len);
+                    _pos = i + 1;
+                    return line;
+                }
+            }
+
+            if (_pos < _bytes.Length)
+            {
+                line = new ByteString(_bytes, _pos, _bytes.Length - _pos);
+            }
+
+            _pos = _bytes.Length;
+            return line;
+        }
+    }
+}
\ No newline at end of file
